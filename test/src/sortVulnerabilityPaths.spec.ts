import { sortVulnerabilityPaths } from '../../src/sortVulnerabilityPaths';

describe('sortVulnerabilityPaths', () => {
  it('sorts different ids smallest to biggest', () => {
    expect(
      sortVulnerabilityPaths([
        '25|name',
        '1234|name',
        '1|name',
        '1000|name',
        '250|name',
        '2|name',
        '1432|name'
      ])
    ).toStrictEqual([
      '1|name',
      '2|name',
      '25|name',
      '250|name',
      '1000|name',
      '1234|name',
      '1432|name'
    ]);
  });

  it('sorts paths with the same id alphabetically', () => {
    expect(
      sortVulnerabilityPaths([
        '1|abc>def',
        '11|abc>def',
        '11|def>ghi',
        '11|abc',
        '11|abc>def>ghi',
        '250|abc',
        '1432|xyz>def',
        '1432|abc>def>ghi',
        '1432|xyz>abc',
        '1432|abc'
      ])
    ).toStrictEqual([
      '1|abc>def',
      '11|abc',
      '11|abc>def',
      '11|abc>def>ghi',
      '11|def>ghi',
      '250|abc',
      '1432|abc',
      '1432|abc>def>ghi',
      '1432|xyz>abc',
      '1432|xyz>def'
    ]);
  });
});
